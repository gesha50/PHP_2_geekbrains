<?phprequire 'm/M_User.php';class C_User extends C_Base{    public function action_auth(){		$this->title = 'Регистрация';        $user = new M_User();		$info = false;        if($_POST['submit']){            $login = trim(strip_tags($_POST['login']));            if(strtolower($login) == 'admin'){                exit("Логин админа нельзя зарегистрировать!");            }            $info = $user->getAll('users');            foreach ($info as $item) {                if($login == $item['login']){                    exit("Такой уже логин есть!");                }            }            if (filter_var($_POST['email'], FILTER_VALIDATE_EMAIL)) {                $email = trim(strip_tags($_POST['email']));            }            $pass = trim(strip_tags($_POST['pass']));            $info = $user->reg($login,md5($pass),$email);            if ($info) {                $this->content = $this->Template('v/v_auth.php', ['text' => "Регистрация Зашершена! <br> Теперь Вам необходимо <a href='index.php?c=User&act=login'>войти</a>"]);            } else {                $this->content = $this->Template('v/v_auth.php', ['text' => "Вы не зарегестрировались :("]);            }		}		else{		   $this->content = $this->Template('v/v_auth.php', ['text' => "Пожалуйста зарегестрируйтесь"]);		}	}	public function action_exit (){        unset($_SESSION['login']);        unset($_SESSION['pass']);        session_destroy();        header('Location: index.php');    }    public function action_login (){        $this->title = 'Вход';        if($_POST['enter']) {            $login = trim(strip_tags($_POST['login']));            $pass = trim(strip_tags($_POST['pass']));            $user = new M_User();            $info = $user->getAll('users');            $isUserLogin = false;            foreach ($info as $item) {                if($login == $item['login'] and md5($pass) == $item['pass']){                    //$message = "Поздравляем Вы в личном кабинете!";                    $_SESSION['login'] = $login;                    $_SESSION['pass'] = $pass;                    $isUserLogin = true;                    header('location: index.php?c=User&act=kabinet');                    //$this->content = $this->Template('v/v_kabinet.php', ['text' => $message]);                }                if (!$isUserLogin){                    $message = "Не правильно ввели данные!";                    $this->content = $this->Template('v/v_kabinet.php', ['text' => $message]);                }            }        }        else{            $this->content = $this->Template('v/v_login.php', ['text' => "Пожалуйста войдите в личный кабинет"]);        }    }    public function action_kabinet (){        $this->title = 'Кабинет';        $message = "Поздравляем Вы в личном кабинете!";        $this->content = $this->Template('v/v_kabinet.php', ['text' => $message]);    }}